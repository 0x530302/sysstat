.TH TAPESTAT 1 "AUGUST 2015" Linux "Linux User's Manual" -*- nroff -*-
.SH NAME
tapestat \- Report tape statistics.
.SH SYNOPSIS
.B tapestat [ -k | -m ] [ -t ] [ -V ] [ -y ] [ -z ] [
.I interval
.B [
.I count
.B ] ]
.SH DESCRIPTION
The
.B tapestat
command is used for monitoring the activity of tape drives connected to a system.

The first report generated by the
.B tapestat
command provides statistics
concerning the time since the system was booted, unless the
.B -y
option is used, vhen this first report is omitted.
Each subsequent report
covers the time since the previous report.

The
.I interval
parameter specifies the amount of time in seconds between
each report.
The
.I count
parameter can be specified in conjunction with the
.I interval
parameter. If the
.I count
parameter is specified, the value of
.I count
determines the number of reports generated at
.I interval
seconds apart. If the
.I interval
parameter is specified without the
.I count
parameter, the
.B tapestat
command generates reports continuously.

.SH REPORT
The
.B tapestat
report provides statistics for each tape drive connected to the system.
The following data are displayed:

.B r/s 
.RS
The number of reads issued expressed as the number per second averaged over the interval.

.RE
.B w/s
.RS
The number of writes issued expressed as the number per second averaged over the interval.

.RE
.B kB_read/s | MB_read/s
.RS
The amount of data read expressed in kilobytes (by default or if option -k used) or
Megabytes (if option -m used) per second averaged over the interval.

.RE
.B kB_wrtn/s | MB_wrtn/s
.RS
The amount of data written expressed in kilobytes (by default or if option -k used) or
Megabytes (if option -m used) per second averaged over the interval.

.RE
.B %Rd
.RS
Read percentage wait - The percentage of time over the interval spent waiting for read requests
to complete.
The time is measured from when the request is dispatched to the SCSI mid-layer until it signals
that it completed.

.RE
.B %Wr
.RS
Write percentage wait - The percentage of time over the interval spent waiting for write requests
to complete. The time is measured from when the request is dispatched to the SCSI mid-layer until
it signals that it completed.

.RE
.B %Oa
.RS
Overall percentage wait - The percentage of time over the interval spent waiting for any
I/O request to complete (read, write, and other).

.RE
.B Rs/s
.RS
The number of I/Os, expressed as the number per second averaged over the interval, where
a non-zero residual value was encountered.

.RE
.B Ot/s
.RS
The number of I/Os, expressed as the number per second averaged over the interval, that
were included as "other". Other I/O includes ioctl calls made to the tape driver and
implicit operations performed by the tape driver such as rewind on close
(for tape devices that implement rewind on close). It does not include any I/O performed
using methods outside of the tape driver (e.g. via sg ioctls).
.RE
.RE
.SH OPTIONS
.IP -k
Show the amount of data written or read in kilobytes per second instead of Megabytes.
This option is mutually exclusive with -m.
.IP -m
Show the amount of data written or read in Megabytes per second instead of kilobytes.
This option is mutually exclusive with -k.
.IP -t
Display time stamps. The time stamp format may depend
on the value of the S_TIME_FORMAT environment variable (see below).
.IP -V
Print version and exit.
.IP -y
Omit the initial statistic showing values since boot.
.IP -z
Tell
.B tapestat
to omit output for any tapes for which there was no activity
during the sample period.

.SH CONSIDERATIONS
It is possible for a percentage value (read, write, or other) to be greater than 100 percent
(the
.B tapestat
command will never show a percentage value more than 999).
If rewinding a tape takes 40 seconds where the interval time is 5 seconds the %Oa value
would show as 0 in the intervals before the rewind completed and then show as approximately
800 percent when the rewind completes. 

Similar values will be observed for %Rd and %Wr if a tape drive stops reading or writing
and then restarts (that is it stopped streaming). In such a case you may see the r/s or w/s drop to zero and the %Rd/%Wr value could be higher than 100 when reading or writing continues
(depending on how long it takes to restart writing or reading).
This is only an issue if it happens a lot as it may cause tape wear and will impact
on the backup times.

For fast tape drives you may see low percentage wait times.
This does not indicate an issue with the tape drive. For a slower tape drive (e.g. an older
generation DDS drive) the speed of the tape (and tape drive) is much slower than filesystem I/O,
percent wait times are likely to be higher. For faster tape drives (e.g. LTO) the percentage
wait times are likely to be lower as program writing to or reading from tape is going
to be doing a lot more filesystem I/O because of the higher throughput.

.SH ENVIRONMENT
The
.B tapestat
command takes into account the following environment variable:

.IP S_TIME_FORMAT
If this variable exists and its value is
.BR ISO
then the current locale will be ignored when printing the date in the report
header. The
.B tapestat
command will use the ISO 8601 format (YYYY-MM-DD) instead.
The timestamp displayed with option -t will also be compliant with ISO 8601
format.

.SH BUGS
.I /sys
filesystem must be mounted for
.B tapestat
to work. It will not work on kernels that do not have sysfs support

This command requires kernel version 4.2 or later
(or tape statistics support backported for an earlier kernel version).

.SH FILES
.I /sys/class/scsi_tape/st<num>/stats/*
Statistics files for tape devices.

.I /proc/uptime
contains system uptime.
.SH AUTHOR
Initial revision by Shane M. SEYMOUR (shane.seymour <at> hp.com)
.br
Modified for sysstat by Sebastien Godard (sysstat <at> orange.fr)
.SH SEE ALSO
.BR iostat (1),
.BR mpstat (1)

.I http://pagesperso-orange.fr/sebastien.godard/
